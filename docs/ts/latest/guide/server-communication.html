<!DOCTYPE html><html lang="en" ng-app="angularIOApp" itemscope itemtype="http://schema.org/Framework"><!-- template: public/docs/_layout--><head><title>HTTP Client - ts - GUIDE</title><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Angular is a development platform for building mobile and desktop web applications"/><meta name="keywords" content="Angular, AngularJS, AngularDart, Javscript, Dart, Framework, JavaScript MVC, Google"/><meta name="robots" content="all"/><meta name="referrer" content="origin"/><meta name="viewport" id="viewport" content="width=device-width, initial-scale=1"/><meta property="og:title" content="Angular"/><meta property="og:image" content="/resources/images/logos/standard/shield-large.png"/><meta property="og:image:type" content="image/png"/><meta property="og:image:width" content="184"/><meta property="og:image:height" content="200"/><meta property="og:description" content="Angular is a development platform for building mobile and desktop web applications"/><meta itemprop="name" content="Angular"/><meta itemprop="description" content="Angular is a development platform for building mobile and desktop web applications"/><meta itemprop="image" content="https://angular.io/resources/images/logos/standard/shield-large.png"/><link rel="icon" type="image/x-icon" href="/resources/images/icons/favicon.ico"/><link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.0.0/angular-material.min.css"/><link href="https://fonts.googleapis.com/css?family=Roboto:400,300,500,400italic,700" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/><link rel="stylesheet" href="/resources/css/vendor/icomoon/style.css"/><link rel="stylesheet" href="/resources/css/vendor/animate.css"/><link rel="stylesheet" href="/resources/css/main.css"/><!-- MOBILE ICONS -->
<link rel="apple-touch-icon" sizes="57x57" href="/resources/images/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/resources/images/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/resources/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/resources/images/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/resources/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/resources/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/resources/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/resources/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/resources/images/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/resources/images/favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/resources/images/favicons/manifest.json"></head><body ng-controller="AppCtrl as appCtrl" class="l-offset-nav l-offset-side-nav"><nav data-swiftype-index="false" scroll-y-offset-element="scroll-y-offset-element" class="main-nav l-pinned-top l-layer-5"><h1><a href="/" md-button>Angular <sup>by Google</sup></a></h1><button aria-label="View Menu" ng-click="appCtrl.toggleMainMenu($event)" md-button="md-button" class="main-nav-button main-nav-mobile-trigger l-right">Site Menu <span class="icon icon-arrow-drop-down"></span></button><ul ng-class="appCtrl.showMainNav ? 'is-visible' : ''"><li class="l-left"><a class="main-nav-button" href="/features.html" md-button>Features</a></li><li class="l-left"><a class="main-nav-button" href="/docs/ts/latest/" md-button>Docs</a></li><li class="l-left"><a class="main-nav-button" href="/events.html" md-button>Events</a></li><li class="l-right"><a class="main-nav-button" href="/docs/ts/latest/quickstart.html" md-button>Get Started</a></li></ul></nav><!-- Include this file ONLY when current.path[2] is defined--><nav data-swiftype-index="false" ng-class="appCtrl.showDocsNav ? 'is-visible' : ''" class="sidenav l-pinned-left l-layer-4 l-offset-nav"><!-- SEARCH BAR--><header class="sidenav-search st-input-wrapper"><div class="st-input-inner"><label for="search-io" class="is-hidden">Search Docs</label><input type="text" placeholder="SEARCH DOCS..." class="st-default-search-input"/></div><button aria-label="View Docs Menu" ng-click="appCtrl.toggleDocsMenu($event)" md-button="md-button" class="mobile-trigger button">Docs <span class="icon icon-arrow-drop-down"></span></button></header><ul class="sidenav-links"><li class="sidenav-section no-border"><a href="/docs/ts/latest/" class="nav-title">Docs Home</a></li><!-- CORE DOCUMENTATION--><li class="sidenav-section-divider"><h3>Core Documentation</h3></li><li class="sidenav-section"><a href="/docs/ts/latest/quickstart.html" title="Quickstart" class="nav-title ">Quickstart</a></li><li class="sidenav-section"><a href="/docs/ts/latest/cli-quickstart.html" title="CLI Quickstart" class="nav-title ">CLI Quickstart</a></li><li class="sidenav-section"><a href="/docs/ts/latest/guide/" title="How to read and use this documentation." class="nav-title is-parent ">Guide<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-ordered-lists is-hidden"><ul><li class="nav-list-item "><a href="/docs/ts/latest/guide/" title="How to read and use this documentation.">1. Overview</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/setup.html" title="Install the Angular QuickStart seed for faster, more efficient development on your machine.">2. Setup</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/learning-angular.html" title="A suggested path through the documentation for Angular newcomers.">3. Learning Angular</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/architecture.html" title="The basic building blocks of Angular applications.">4. Architecture</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/appmodule.html" title="Tell Angular how to construct and bootstrap the app in the root &quot;AppModule&quot;.">5. The Root Module</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/displaying-data.html" title="Property binding helps show app data in the UI.">6. Displaying Data</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/user-input.html" title="User input triggers DOM events. We listen to those events with event bindings that funnel updated values back into our components and models.">7. User Input</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/forms.html" title="A form creates a cohesive, effective, and compelling data entry experience. An Angular form coordinates a set of data-bound user controls, tracks changes, validates input, and presents errors.">8. Forms</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/dependency-injection.html" title="Angular's dependency injection system creates and delivers dependent services &quot;just-in-time&quot;.">9. Dependency Injection</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/template-syntax.html" title="Learn how to write templates that display data and consume user events with the help of data binding.">10. Template Syntax</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/cheatsheet.html" title="Cheat Sheet">11. Cheat Sheet</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/style-guide.html" title="Write Angular with style.">12. Style Guide</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/glossary.html" title="Brief definitions of the most important words in the Angular vocabulary.">13. Glossary</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/change-log.html" title="An annotated history of recent documentation improvements.">14. Change Log</a></li></ul></div></li><li class="sidenav-section no-border"><a href="/docs/ts/latest/api/" title="API Reference" class="nav-title ">API Reference</a></li><!-- ADVANCED DOCUMENATION--><li class="sidenav-section-divider"><h3>Additional Documentation</h3></li><li class="sidenav-section"><a href="/docs/ts/latest/tutorial/" title="The Tour of Heroes tutorial takes you through the steps of creating an Angular application in TypeScript." class="nav-title is-parent ">Tutorial<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-ordered-lists is-hidden"><ul><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/" title="The Tour of Heroes tutorial takes you through the steps of creating an Angular application in TypeScript.">1. Introduction</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt1.html" title="We build a simple hero editor.">2. The Hero Editor</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt2.html" title="We build a master/detail page with a list of heroes.">3. Master/Detail</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt3.html" title="We refactor the master/detail view into separate components.">4. Multiple Components</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt4.html" title="We create a reusable service to manage our hero data calls.">5. Services</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt5.html" title="We add the Angular Router and learn to navigate among the views.">6. Routing</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt6.html" title="We convert our service and components to use Angular's HTTP service.">7. HTTP</a></li></ul></div></li><li class="sidenav-section"><a href="/docs/ts/latest/guide/animations.html" title="A guide to Angular's animation system." class="nav-title is-parent is-selected">Advanced<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-unordered-lists"><ul><li class="nav-list-item "><a href="/docs/ts/latest/guide/animations.html" title="A guide to Angular's animation system.">Animations</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/attribute-directives.html" title="Attribute directives attach behavior to elements.">Attribute Directives</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/browser-support.html" title="Browser support and polyfills guide.">Browser support</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/component-styles.html" title="Learn how to apply CSS styles to components.">Component Styles</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/deployment.html" title="Learn how to deploy your Angular app.">Deployment</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/hierarchical-dependency-injection.html" title="Angular's hierarchical dependency injection system supports nested injectors in parallel with the component tree.">Hierarchical Injectors</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/reactive-forms.html" title="Create a reactive form using FormBuilder, groups, and arrays.">Reactive Forms</a></li><li class="nav-list-item is-selected"><a href="/docs/ts/latest/guide/server-communication.html" title="Use an HTTP Client to talk to a remote server.">HTTP Client</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/lifecycle-hooks.html" title="Angular calls lifecycle hook methods on directives and components as it creates, changes, and destroys them.">Lifecycle Hooks</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/ngmodule.html" title="Define application modules with @NgModule.">NgModules</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/npm-packages.html" title="Recommended npm packages, and how to specify package dependencies.">Npm Packages</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/pipes.html" title="Pipes transform displayed values within a template.">Pipes</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/router.html" title="Discover the basics of screen navigation with the Angular Router.">Routing &amp; Navigation</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/security.html" title="Developing for content security in Angular applications.">Security</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/setup-systemjs-anatomy.html" title="Inside the local development environment for SystemJS.">Setup Anatomy</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/structural-directives.html" title="Angular has a powerful template engine that lets us easily manipulate the DOM structure of our elements.">Structural Directives</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/testing.html" title="Techniques and practices for testing an Angular app.">Testing</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/typescript-configuration.html" title="TypeScript configuration for Angular developers.">TypeScript Configuration</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/upgrade.html" title="Incrementally upgrade an AngularJS application to Angular.">Upgrading from AngularJS</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/webpack.html" title="Create Angular applications with a Webpack based tooling.">Webpack: an introduction</a></li></ul></div></li><li class="sidenav-section"><a href="/docs/ts/latest/cookbook/" title="A collection of recipes for common Angular application scenarios." class="nav-title is-parent ">Cookbook<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-unordered-lists is-hidden"><ul><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/" title="A collection of recipes for common Angular application scenarios.">Overview</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/aot-compiler.html" title="Learn how to use Ahead-of-time compilation.">Ahead-of-Time Compilation</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/ajs-quick-reference.html" title="Learn how AngularJS concepts and techniques map to Angular.">AngularJS to Angular</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/component-communication.html" title="Share information between different directives and components.">Component Interaction</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/dependency-injection.html" title="Techniques for Dependency Injection.">Dependency Injection</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/dynamic-component-loader.html" title="Load components dynamically.">Dynamic Component Loader</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/dynamic-form.html" title="Render dynamic forms with FormGroup.">Dynamic Forms</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/form-validation.html" title="Validate user's form entries.">Form Validation</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/i18n.html" title="Translate the app's template text into multiple languages.">Internationalization (i18n)</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/ngmodule-faq.html" title="Answers to frequently asked questions about @NgModule.">NgModule FAQs</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/set-document-title.html" title="Setting the document or window title using the Title service.">Set the Document Title</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/ts-to-js.html" title="Convert Angular TypeScript examples into ES6 and ES5 JavaScript.">TypeScript to JavaScript</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/visual-studio-2015.html" title="Use Visual Studio 2015 with the QuickStart files.">Visual Studio 2015 QuickStart</a></li></ul></div></li></ul><nav class="dropdown"><button aria-label="Select a version of Angular" md-button="md-button" ng-click="appCtrl.toggleVersionMenu($event)" class="dropdown-button">Angular for TypeScript  <span class="icon icon-arrow-drop-down"></span></button><div ng-click="appCtrl.toggleVersionMenu($event)" ng-show="appCtrl.showMenu" class="overlay ng-hide"></div><ul ng-class="appCtrl.showMenu ? 'is-visible' : ''" class="dropdown-menu"><li><a href="/docs/ts/latest/guide/server-communication.html" md-button>Angular for TypeScript </a></li><li><a href="/docs/js/latest/guide/server-communication.html" md-button>Angular for JavaScript </a></li></ul></nav></nav><script>// Could put in appCtrl but only needed here and clear here
(function scrollToSelectedLink() {
  var sideNav = document.getElementsByClassName('sidenav')[0];
  var link = sideNav.getElementsByClassName('is-selected')[0];
  if(link && link.offsetTop > window.innerHeight){
    sideNav.scrollTop = link.offsetTop - (window.innerHeight/2);
    //alert("offsetTop: " + link.offsetTop + " side-nav top is " + sideNav.scrollTop);
  }
})()</script><header class="hero background-sky"><h1 class="hero-title ">HTTP Client </h1><div class="clear"></div></header><div class="banner"><p class="text-body">Use an HTTP Client to talk to a remote server.</p></div><article class="l-content-small grid-fluid docs-content"><script>function why(id, backTo) {
  var id = "#"+id;
  var el = document.querySelector(id);
  el.hidden=el.hidden=!el.hidden;

  if (el.hidden && backTo){
    // the next line is required to work around a bug in WebKit (Chrome / Safari)
    location.href = "#";
    location.href =  "#" + backTo;
  }
}</script><script>function verbose(isVerbose) {
  isVerbose = !! isVerbose;
  var el = document.querySelector('button.verbose.off');
  el.style.display = isVerbose ? 'block' : 'none';
  var el = document.querySelector('button.verbose.on');
  el.style.display = isVerbose ? 'none' : 'block';

  CCSStylesheetRuleStyle('main','.l-verbose-section', 'display',
    isVerbose ? 'block' : 'none');
}
</script><script>function CCSStylesheetRuleStyle(stylesheet, selectorText, style, value){
  /* returns the value of the element style of the rule in the stylesheet
  *  If no value is given, reads the value
  *  If value is given, the value is changed and returned
  *  If '' (empty string) is given, erases the value.
  *  The browser will apply the default one
  *
  * string stylesheet: part of the .css name to be recognized, e.g. 'default'
  * string selectorText: css selector, e.g. '#myId', '.myClass', 'thead td'
  * string style: camelCase element style, e.g. 'fontSize'
  * string value optional : the new value
  */
  var CCSstyle = undefined, rules, sheet;
  for(var m in document.styleSheets){
    sheet = document.styleSheets[m];
    if(sheet.href && sheet.href.indexOf(stylesheet) != -1){
    rules = sheet[document.all ? 'rules' : 'cssRules'];
    for(var n in rules){
      console.log(rules[n].selectorText);
      if(rules[n].selectorText == selectorText){
        CCSstyle = rules[n].style;
        break;
      }
    }
    break;
    }
  }
  if(value == undefined)
    return CCSstyle[style]
  else
    return CCSstyle[style] = value
}
</script><p><a href="https://tools.ietf.org/html/rfc2616">HTTP</a> is the primary protocol for browser/server communication.</p>
<div class="l-sub-section"><p>The <a href="https://tools.ietf.org/html/rfc6455"><code>WebSocket</code></a> protocol is another important communication technology;
it isn&#39;t covered in this page.</p>
</div><p>Modern browsers support two HTTP-based APIs:
<a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest">XMLHttpRequest (XHR)</a> and
<a href="https://en.wikipedia.org/wiki/JSONP">JSONP</a>. A few browsers also support
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch</a>.</p>
<p>The Angular HTTP library simplifies application programming with the <strong>XHR</strong> and <strong>JSONP</strong> APIs.</p>
<h1 id="contents">Contents</h1>
<ul>
<li><a href="#demos">Demos</a></li>
<li><a href="#http-providers">Providing HTTP Services</a></li>
<li><a href="#http-client">The Tour of Heroes <em>HTTP</em> client demo</a><ul>
<li><a href="#HeroListComponent">The <code>HeroListComponent</code> class</a></li>
</ul>
</li>
<li><a href="#fetch-data">Fetch data with <code>http.get()</code></a></li><li if-docs="ts"> <a href="#rxjs-library">RxJS library</a>
<ul>
  <li> <a href="#enable-rxjs-operators">Enable RxJS operators</a></li>
</ul>
</li>
<li><a href="#extract-data">Process the response object</a><ul>
<li><a href="#parse-to-json">Parse to <code>JSON</code></a></li>
<li><a href="#no-return-response-object">Do not return the response object</a></li>
<li><a href="#error-handling">Always handle errors</a></li>
<li><a href="#hero-list-component"><code>HeroListComponent</code> error handling</a></li>
</ul>
</li>
<li><a href="#update">Send data to the server</a><ul>
<li><a href="#headers">Headers</a></li>
<li><a href="#json-results">JSON results</a></li>
</ul>
</li>
</ul>
<ul><li if-docs="ts"> <a href="#promises">Fall back to promises</a></li></ul>

<ul>
<li><a href="#cors">Cross-Origin Requests: Wikipedia example</a><ul if-docs="ts">
<li> <a href="#search-wikipedia">Search Wikipedia</a></li>
<li> <a href="#search-parameters">Search parameters</a></li>
<li> <a href="#wikicomponent">The WikiComponent</a></li>
</ul></li>
<li><a href="#wasteful-app">A wasteful app</a></li><li if-docs="ts"> <a href="#more-observables">More fun with Observables</a>
  <ul>
    <li> <a href="#create-stream">Create a stream of search terms</a></li>
    <li> <a href="#listen-for-search-terms">Listen for search terms</a></li>
  </ul>
</li>
<li><a href="#xsrf">Guarding against Cross-Site Request Forgery</a></li>
<li><a href="#override-default-request-options">Override default request headers (and other request options)</a></li>
<li><a href="#in-mem-web-api">Appendix: Tour of Heroes <em>in-memory web api</em></a></li>
</ul>
<p>A <live-example>live example</live-example> illustrates these topics.</p>
<a id="demos"></a><div class="l-main-section"></div><h1 id="demos">Demos</h1>
<p>This page describes server communication with the help of the following demos:</p>
<ul>
<li><a href="#http-client">The Tour of Heroes <em>HTTP</em> client demo</a>.</li>
<li><a href="#promises">Fall back to Promises</a>.</li>
<li><a href="#cors">Cross-Origin Requests: Wikipedia example</a>.</li>
<li><a href="#more-observables">More fun with Observables</a>.</li>
</ul>
<p>The root <code>AppComponent</code> orchestrates these demos:</p>
<div class="code-example"><header><h4>src/app/app.component.ts</h4></header><code-example language="ts" format="linenums">import { Component }         from &#39;@angular/core&#39;;

@Component({
  selector: &#39;my-app&#39;,
  template: `
    &lt;hero-list&gt;&lt;/hero-list&gt;
    &lt;hero-list-promise&gt;&lt;/hero-list-promise&gt;
    &lt;my-wiki&gt;&lt;/my-wiki&gt;
    &lt;my-wiki-smart&gt;&lt;/my-wiki-smart&gt;
  `
})
export class AppComponent { }
</code-example></div><div id="http-providers" class="l-main-section"></div><h1 id="providing-http-services">Providing HTTP services</h1>
<p>First, configure the application to use server communication facilities.</p>
<p>The Angular <code>Http</code> client communicates with the server using a familiar HTTP request/response protocol.
The <code>Http</code> client is one of a family of services in the Angular HTTP library.</p>
<div class="l-sub-section"><p>When importing from the <code>@angular/http</code> module, SystemJS knows how to load services from
the Angular HTTP library
because the <code>systemjs.config.js</code> file maps to that module name.</p>
</div><p>Before you can use the <code>Http</code> client, you need to register it as a service provider with the dependency injection system.</p>
<div class="l-sub-section"><p>Read about providers in the <a href="dependency-injection.html">Dependency Injection</a> page.</p>
</div><p>Register providers by importing other NgModules to the root NgModule in <code>app.module.ts</code>.</p>
<div class="code-example"><header><h4>src/app/app.module.ts (v1)</h4></header><code-example language="ts" format="">import { NgModule }      from &#39;@angular/core&#39;;
import { BrowserModule } from &#39;@angular/platform-browser&#39;;
import { FormsModule }   from &#39;@angular/forms&#39;;
import { HttpModule, JsonpModule } from &#39;@angular/http&#39;;

import { AppComponent } from &#39;./app.component&#39;;

@NgModule({
  imports: [
    BrowserModule,
    FormsModule,
    HttpModule,
    JsonpModule
  ],
  declarations: [ AppComponent ],
  bootstrap:    [ AppComponent ]
})
export class AppModule {
}
</code-example></div><p>Begin by importing the necessary members.
The newcomers are the <code>HttpModule</code> and the <code>JsonpModule</code> from the Angular HTTP library. For more information about imports and related terminology, see the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import">MDN reference</a> on the <code>import</code> statement.</p>
<p>To add these modules to the application, pass them to the <code>imports</code> array in the root <code>@NgModule</code>.</p>
<div class="l-sub-section"><p>The <code>HttpModule</code> is necessary for making HTTP calls.
Though the <code>JsonpModule</code> isn&#39;t necessary for plain HTTP,
there is a JSONP demo later in this page.
Loading its module now saves time.</p>
</div><div id="http-client" class="l-main-section"></div><h2 id="the-tour-of-heroes-http-client-demo">The Tour of Heroes HTTP client demo</h2>
<p>The first demo is a mini-version of the <a href="../tutorial">tutorial</a>&#39;s &quot;Tour of Heroes&quot; (ToH) application.
This version gets some heroes from the server, displays them in a list, lets the user add new heroes, and saves them to the server.
The app uses the Angular <code>Http</code> client to communicate via <strong>XMLHttpRequest (XHR)</strong>.</p>
<p>It works like this:</p>
<figure class="image-display"><img src="/resources/images/devguide/server-communication/http-toh.gif" alt="ToH mini app" width="250"></figure><p>This demo has a single component, the <code>HeroListComponent</code>.  Here&#39;s its template:</p>
<div class="code-example"><header><h4>src/app/toh/hero-list.component.html</h4></header><code-example language="html" format="linenums">&lt;h1&gt;Tour of Heroes ({{mode}})&lt;/h1&gt;
&lt;h3&gt;Heroes:&lt;/h3&gt;
&lt;ul&gt;
  &lt;li *ngFor=&quot;let hero of heroes&quot;&gt;{{hero.name}}&lt;/li&gt;
&lt;/ul&gt;

&lt;label&gt;New hero name: &lt;input #newHeroName /&gt;&lt;/label&gt;
&lt;button (click)=&quot;addHero(newHeroName.value); newHeroName.value=&#39;&#39;&quot;&gt;Add Hero&lt;/button&gt;

&lt;p class=&quot;error&quot; *ngIf=&quot;errorMessage&quot;&gt;{{errorMessage}}&lt;/p&gt;
</code-example></div><p>It presents the list of heroes with an <code>ngFor</code>.
Below the list is an input box and an <em>Add Hero</em> button where you can enter the names of new heroes
and add them to the database.
A <a href="template-syntax.html#ref-vars">template reference variable</a>, <code>newHeroName</code>, accesses the
value of the input box in the <code>(click)</code> event binding.
When the user clicks the button, that value is passed to the component&#39;s <code>addHero</code> method and then
the event binding clears it to make it ready for a new hero name.</p>
<p>Below the button is an area for an error message.</p>
<a id="oninit"></a><a id="HeroListComponent"></a><h3 id="the-herolistcomponent-class">The <em>HeroListComponent</em> class</h3>
<p>Here&#39;s the component class:</p>
<div class="code-example"><header><h4>src/app/toh/hero-list.component.ts (class)</h4></header><code-example language="ts" format="linenums">export class HeroListComponent implements OnInit {
  errorMessage: string;
  heroes: Hero[];
  mode = &#39;Observable&#39;;

  constructor (private heroService: HeroService) {}

  ngOnInit() { this.getHeroes(); }

  getHeroes() {
    this.heroService.getHeroes()
                     .subscribe(
                       heroes =&gt; this.heroes = heroes,
                       error =&gt;  this.errorMessage = &lt;any&gt;error);
  }

  addHero(name: string) {
    if (!name) { return; }
    this.heroService.create(name)
                     .subscribe(
                       hero  =&gt; this.heroes.push(hero),
                       error =&gt;  this.errorMessage = &lt;any&gt;error);
  }
}
</code-example></div><p>Angular <a href="dependency-injection.html">injects</a> a <code>HeroService</code> into the constructor
and the component calls that service to fetch and save data.</p>
<p>The component <strong>does not talk directly to the Angular <code>Http</code> client</strong>.
The component doesn&#39;t know or care how it gets the data.
It delegates to the <code>HeroService</code>.</p>
<p>This is a golden rule: <strong>always delegate data access to a supporting service class</strong>.</p>
<p>Although <em>at runtime</em> the component requests heroes immediately after creation,
you <strong>don&#39;t</strong> call the service&#39;s <code>get</code> method in the component&#39;s constructor.
Instead, call it inside the <code>ngOnInit</code> <a href="lifecycle-hooks.html">lifecycle hook</a>
and rely on Angular to call <code>ngOnInit</code> when it instantiates this component.</p>
<div class="l-sub-section"><p>This is a <em>best practice</em>.
Components are easier to test and debug when their constructors are simple, and all real work
(especially calling a remote server) is handled in a separate method.</p>
</div><p>The service&#39;s <code>getHeroes()</code> and <code>create()</code> methods return an <code>Observable</code> of hero data that the Angular <code>Http</code> client fetched from the server.</p>
<p>Think of an <code>Observable</code> as a stream of events published by some source.
To listen for events in this stream, <strong><em>subscribe</em></strong> to the <code>Observable</code>.
These subscriptions specify the actions to take when the web request
produces a success event (with the hero data in the event payload) or a fail event (with the error in the payload).</p>
<p>With a basic understanding of the component, you&#39;re ready to look inside the <code>HeroService</code>.</p>
<a id="HeroService"></a><div id="fetch-data" class="l-main-section"></div><h2 id="fetch-data-with-_http-get-_">Fetch data with <em>http.get()</em></h2>
<p>In many of the previous samples the app faked the interaction with the server by
returning mock heroes in a service like this one:</p>
<div class="code-example"><code-example language="ts" format="">import { Injectable } from &#39;@angular/core&#39;;

import { Hero } from &#39;./hero&#39;;
import { HEROES } from &#39;./mock-heroes&#39;;

@Injectable()
export class HeroService {
  getHeroes(): Promise&lt;Hero[]&gt; {
    return Promise.resolve(HEROES);
  }
}
</code-example></div><p>You can revise that <code>HeroService</code> to get the heroes from the server using the Angular <code>Http</code> client service:</p>
<div class="code-example"><header><h4>src/app/toh/hero.service.ts (revised)</h4></header><code-example language="ts" format="linenums">import { Injectable }              from &#39;@angular/core&#39;;
import { Http, Response }          from &#39;@angular/http&#39;;

import { Observable } from &#39;rxjs/Observable&#39;;
import &#39;rxjs/add/operator/catch&#39;;
import &#39;rxjs/add/operator/map&#39;;

import { Hero } from &#39;./hero&#39;;

@Injectable()
export class HeroService {
  private heroesUrl = &#39;api/heroes&#39;;  // URL to web API

  constructor (private http: Http) {}

  getHeroes(): Observable&lt;Hero[]&gt; {
    return this.http.get(this.heroesUrl)
                    .map(this.extractData)
                    .catch(this.handleError);
  }
  private extractData(res: Response) {
    let body = res.json();
    return body.data || { };
  }

  private handleError (error: Response | any) {
    // In a real world app, you might use a remote logging infrastructure
    let errMsg: string;
    if (error instanceof Response) {
      const body = error.json() || &#39;&#39;;
      const err = body.error || JSON.stringify(body);
      errMsg = `${error.status} - ${error.statusText || &#39;&#39;} ${err}`;
    } else {
      errMsg = error.message ? error.message : error.toString();
    }
    console.error(errMsg);
    return Observable.throw(errMsg);
  }
}
</code-example></div><p>Notice that the Angular <code>Http</code> client service is
<a href="dependency-injection.html">injected</a> into the <code>HeroService</code> constructor.</p>
<div class="code-example"><code-example language="ts" format="">constructor (private http: Http) {}
</code-example></div><p>Look closely at how to call <code>http.get</code>:</p>
<div class="code-example"><header><h4>src/app/toh/hero.service.ts (getHeroes)</h4></header><code-example language="ts" format="">getHeroes(): Observable&lt;Hero[]&gt; {
  return this.http.get(this.heroesUrl)
                  .map(this.extractData)
                  .catch(this.handleError);
}
</code-example></div><p>You pass the resource URL to <code>get</code> and it calls the server which returns heroes.</p>
<div class="l-sub-section"><p>The server returns heroes once you&#39;ve set up the <a href="#in-mem-web-api">in-memory web api</a>
described in the appendix below.
Alternatively, you can temporarily target a JSON file by changing the endpoint URL:</p>
<div class="code-example"><code-example language="ts" format="">private heroesUrl = &#39;app/heroes.json&#39;; // URL to JSON file
</code-example></div></div><p><a id="rxjs"></a>
If you are familiar with asynchronous methods in modern JavaScript, you might expect the <code>get</code> method to return a
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" title="Promise">promise</a>.
You&#39;d expect to chain a call to <code>then()</code> and extract the heroes.
Instead you&#39;re calling a <code>map()</code> method.
Clearly this is not a promise.</p>
<p>In fact, the <code>http.get</code> method returns an <strong>Observable</strong> of HTTP Responses (<code>Observable&lt;Response&gt;</code>) from the RxJS library
and <code>map()</code> is one of the RxJS <em>operators</em>.</p>
<a id="rxjs-library"></a><div class="l-main-section"></div><h2 id="rxjs-library">RxJS library</h2>
<p><a href="http://reactivex.io/rxjs" target="_blank" title="RxJS Reactive Extensions">RxJS</a>
is a third party library, endorsed by Angular, that implements the 
<a href="https://www.youtube.com/watch?v=VLGCCpOWFFw" target="_blank" title="Video: Rob Wormald on Observables"><b>asynchronous Observable</b></a> pattern.</p>
<p>All of the Developer Guide samples have installed the RxJS npm package
because Observables are used widely in Angular applications.
<em>This</em> app needs it when working with the HTTP client.
But you must take a critical extra step to make RxJS Observables usable: 
<em>you must import the RxJS operators individually</em>.</p>
<h3 id="enable-rxjs-operators">Enable RxJS operators</h3>
<p>The RxJS library is large.
Size matters when building a production application and deploying it to mobile devices.
You should include only necessary features.</p>
<p>Each code file should add the operators it needs by importing from an RxJS library.
The <code>getHeroes()</code> method needs the <code>map()</code> and <code>catch()</code> operators so it imports them like this.</p>
<div class="code-example"><header><h4>src/app/app.component.ts (import rxjs)</h4></header><code-example language="ts" format="">import { Observable } from &#39;rxjs/Observable&#39;;
import &#39;rxjs/add/operator/catch&#39;;
import &#39;rxjs/add/operator/map&#39;;
</code-example></div><div class="l-main-section"></div><a id="extract-data"></a><h2 id="process-the-response-object">Process the response object</h2>
<p>Remember that the <code>getHeroes()</code> method used an <code>extractData()</code> helper method to map the <code>http.get</code> response object to heroes:</p>
<div class="code-example"><header><h4>src/app/toh/hero.service.ts (excerpt)</h4></header><code-example language="ts" format="">private extractData(res: Response) {
  let body = res.json();
  return body.data || { };
}
</code-example></div><p>The <code>response</code> object doesn&#39;t hold the data in a form the app can use directly.
You must parse the response data into a JSON object.</p>
<a id="parse-to-json"></a><h3 id="parse-to-json">Parse to JSON</h3>
<p>The response data are in JSON string form.
The app must parse that string into JavaScript objects by calling <code>response.json()</code>.</p>
<div class="l-sub-section"><p>This is not Angular&#39;s own design.
The Angular HTTP client follows the Fetch specification for the
<a href="https://fetch.spec.whatwg.org/#response-class">response object</a> returned by the <code>Fetch</code> function.
That spec defines a <code>json()</code> method that parses the response body into a JavaScript object.</p>
</div><div class="l-sub-section"><p>Don&#39;t expect the decoded JSON to be the heroes array directly.
This server always wraps JSON results in an object with a <code>data</code>
property. You have to unwrap it to get the heroes.
This is conventional web API behavior, driven by
<a href="https://www.owasp.org/index.php/OWASP_AJAX_Security_Guidelines#Always_return_JSON_with_an_Object_on_the_outside">security concerns</a>.</p>
</div><div class="alert is-important"><p>Make no assumptions about the server API.
Not all servers return an object with a <code>data</code> property.</p>
</div><a id="no-return-response-object"></a><h3 id="do-not-return-the-response-object">Do not return the response object</h3>
<p>The <code>getHeroes()</code> method <em>could</em> have returned the HTTP response but this wouldn&#39;t
follow best practices.
The point of a data service is to hide the server interaction details from consumers.
The component that calls the <code>HeroService</code> only wants heroes and is kept separate
from getting them, the code dealing with where they come from, and the response object.</p>
<div class="callout is-important"><header>HTTP GET is delayed</header><p>The <code>http.get</code> does <strong>not send the request just yet.</strong> This Observable is
<a href="https://github.com/Reactive-Extensions/RxJS/blob/master/doc/gettingstarted/creating.md#cold-vs-hot-observables"><em>cold</em></a>,
which means that the request won&#39;t go out until something <em>subscribes</em> to the Observable.
That <em>something</em> is the <a href="#subscribe">HeroListComponent</a>.</p>
</div><a id="error-handling"></a><h3 id="always-handle-errors">Always handle errors</h3>
<p>An important part of dealing with I/O is anticipating errors by preparing to catch them
and do something with them. One way to handle errors is to pass an error message
back to the component for presentation to the user,
but only if it says something that the user can understand and act upon.</p>
<p>This simple app conveys that idea, albeit imperfectly, in the way it handles a <code>getHeroes</code> error.</p>
<div class="code-example"><header><h4>src/app/toh/hero.service.ts (excerpt)</h4></header><code-example language="ts" format="">getHeroes(): Observable&lt;Hero[]&gt; {
  return this.http.get(this.heroesUrl)
                  .map(this.extractData)
                  .catch(this.handleError);
}

private handleError (error: Response | any) {
  // In a real world app, you might use a remote logging infrastructure
  let errMsg: string;
  if (error instanceof Response) {
    const body = error.json() || &#39;&#39;;
    const err = body.error || JSON.stringify(body);
    errMsg = `${error.status} - ${error.statusText || &#39;&#39;} ${err}`;
  } else {
    errMsg = error.message ? error.message : error.toString();
  }
  console.error(errMsg);
  return Observable.throw(errMsg);
}
</code-example></div><p>The <code>catch()</code> operator passes the error object from <code>http</code> to the <code>handleError()</code> method.
The <code>handleError</code> method transforms the error into a developer-friendly message, 
logs it to the console, and returns the message in a new, failed Observable via <code>Observable.throw</code>.</p>
<a id="subscribe"></a><a id="hero-list-component"></a><h3><b>HeroListComponent</b> error handling</h3><p>Back in the <code>HeroListComponent</code>, in <code>heroService.getHeroes()</code>,
the <code>subscribe</code> function has a second function parameter to handle the error message.
It sets an <code>errorMessage</code> variable that&#39;s bound conditionally in the <code>HeroListComponent</code> template.</p>
<div class="code-example"><header><h4>src/app/toh/hero-list.component.ts (getHeroes)</h4></header><code-example language="ts" format="">getHeroes() {
  this.heroService.getHeroes()
                   .subscribe(
                     heroes =&gt; this.heroes = heroes,
                     error =&gt;  this.errorMessage = &lt;any&gt;error);
}
</code-example></div><div class="l-sub-section"><p>Want to see it fail? In the <code>HeroService</code>, reset the api endpoint to a bad value. Afterward, remember to restore it.</p>
</div><a id="create"></a>
<a id="update"></a>
<a id="post"></a><div class="l-main-section"></div><h2 id="send-data-to-the-server">Send data to the server</h2>
<p>So far you&#39;ve seen how to retrieve data from a remote location using an HTTP service.
Now you&#39;ll add the ability to create new heroes and save them in the backend.</p>
<p>You&#39;ll write a method for the <code>HeroListComponent</code> to call, a <code>create()</code> method, that takes
just the name of a new hero and returns an <code>Observable</code> of <code>Hero</code>. It begins like this:</p>
<div class="code-example"><code-example language="ts" format="">create(name: string): Observable&lt;Hero&gt; {
</code-example></div><p>To implement it, you must know the server&#39;s API for creating heroes.</p>
<p><a href="#in-mem-web-api">This sample&#39;s data server</a> follows typical REST guidelines.
It expects a <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.5"><code>POST</code></a> request
at the same endpoint as <code>GET</code> heroes.
It expects the new hero data to arrive in the body of the request,
structured like a <code>Hero</code> entity but without the <code>id</code> property.
The body of the request should look like this:</p>
<code-example format="." language="javascript">{ "name": "Windstorm" }</code-example><p>The server generates the <code>id</code> and returns the entire <code>JSON</code> representation
of the new hero including its generated id. The hero arrives tucked inside a response object
with its own <code>data</code> property.</p>
<p>Now that you know how the API works, implement <code>create()</code> as follows:</p>
<div class="code-example"><header><h4>src/app/toh/hero.service.ts (additional imports)</h4></header><code-example language="ts" format="">import { Headers, RequestOptions } from &#39;@angular/http&#39;;
</code-example></div><div class="code-example"><header><h4>src/app/toh/hero.service.ts (create)</h4></header><code-example language="ts" format="">  create(name: string): Observable&lt;Hero&gt; {
    let headers = new Headers({ &#39;Content-Type&#39;: &#39;application/json&#39; });
    let options = new RequestOptions({ headers: headers });

    return this.http.post(this.heroesUrl, { name }, options)
                    .map(this.extractData)
                    .catch(this.handleError);
  }
</code-example></div><a id="headers"></a><h3 id="headers">Headers</h3>
<p>In the <code>headers</code> object, the <code>Content-Type</code> specifies that the body represents JSON.</p>
<p>Next, the <code>headers</code> object is used to configure the <code>options</code> object. The <code>options</code>
object is a new instance of <code>RequestOptions</code>, a class that allows you to specify
certain settings when instantiating a request. In this way, <a href="../api/http/index/Headers-class.html">headers</a> is one of the <a href="../api/http/index/RequestOptions-class.html">RequestOptions</a>.</p>
<p>In the <code>return</code> statement, <code>options</code> is the <em>third</em> argument of the <code>post()</code> method, as shown above.</p>
<a id="json-results"></a><h3 id="json-results">JSON results</h3>
<p>As with <code>getHeroes()</code>, use the <code>extractData()</code> helper to <a href="#extract-data">extract the data</a>
from the response.</p>
<p>Back in the <code>HeroListComponent</code>, its <code>addHero()</code> method subscribes to the Observable returned by the service&#39;s <code>create()</code> method.
When the data arrive it pushes the new hero object into its <code>heroes</code> array for presentation to the user.</p>
<div class="code-example"><header><h4>src/app/toh/hero-list.component.ts (addHero)</h4></header><code-example language="ts" format="">addHero(name: string) {
  if (!name) { return; }
  this.heroService.create(name)
                   .subscribe(
                     hero  =&gt; this.heroes.push(hero),
                     error =&gt;  this.errorMessage = &lt;any&gt;error);
}
</code-example></div><h2 id="promises">Fall back to promises</h2><p>Although the Angular <code>http</code> client API returns an <code>Observable&lt;Response&gt;</code> you can turn it into a
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise&lt;Response&gt;</code></a>.
It&#39;s easy to do, and in simple cases, a Promise-based version looks much
like the Observable-based version.</p>
<div class="l-sub-section"><p>While Promises may be more familiar, Observables have many advantages.</p>
</div><p>Here is a comparison of the <code>HeroService</code> using Promises versus Observables,
highlighting just the parts that are different.</p>
<code-tabs><code-pane language="ts" name="src/app/toh/hero.service.promise.ts (promise-based)" format="linenums">getHeroes (): Promise&lt;Hero[]&gt; {
  return this.http.get(this.heroesUrl)
                  .toPromise()
                  .then(this.extractData)
                  .catch(this.handleError);
}

addHero (name: string): Promise&lt;Hero&gt; {
  let headers = new Headers({ &#39;Content-Type&#39;: &#39;application/json&#39; });
  let options = new RequestOptions({ headers: headers });

  return this.http.post(this.heroesUrl, { name }, options)
             .toPromise()
             .then(this.extractData)
             .catch(this.handleError);
}

private extractData(res: Response) {
  let body = res.json();
  return body.data || { };
}

private handleError (error: Response | any) {
  // In a real world app, we might use a remote logging infrastructure
  let errMsg: string;
  if (error instanceof Response) {
    const body = error.json() || &#39;&#39;;
    const err = body.error || JSON.stringify(body);
    errMsg = `${error.status} - ${error.statusText || &#39;&#39;} ${err}`;
  } else {
    errMsg = error.message ? error.message : error.toString();
  }
  console.error(errMsg);
  return Promise.reject(errMsg);
}
</code-pane><code-pane language="ts" name="src/app/toh/hero.service.ts (observable-based)" format="linenums">  getHeroes(): Observable&lt;Hero[]&gt; {
    return this.http.get(this.heroesUrl)
                    .map(this.extractData)
                    .catch(this.handleError);
  }

  create(name: string): Observable&lt;Hero&gt; {
    let headers = new Headers({ &#39;Content-Type&#39;: &#39;application/json&#39; });
    let options = new RequestOptions({ headers: headers });

    return this.http.post(this.heroesUrl, { name }, options)
                    .map(this.extractData)
                    .catch(this.handleError);
  }

  private extractData(res: Response) {
    let body = res.json();
    return body.data || { };
  }

  private handleError (error: Response | any) {
    // In a real world app, you might use a remote logging infrastructure
    let errMsg: string;
    if (error instanceof Response) {
      const body = error.json() || &#39;&#39;;
      const err = body.error || JSON.stringify(body);
      errMsg = `${error.status} - ${error.statusText || &#39;&#39;} ${err}`;
    } else {
      errMsg = error.message ? error.message : error.toString();
    }
    console.error(errMsg);
    return Observable.throw(errMsg);
  }
</code-pane></code-tabs><p>You can follow the Promise <code>then(this.extractData).catch(this.handleError)</code> pattern as in
this example.</p>
<p>Alternatively, you can call <code>toPromise(success, fail)</code>. The Observable&#39;s <code>map</code> callback moves to the 
first <em>success</em> parameter and its <code>catch</code> callback to the second <em>fail</em> parameter 
in this pattern: <code>.toPromise(this.extractData, this.handleError)</code>.</p>
<p>The <code>errorHandler</code> forwards an error message as a failed <code>Promise</code> instead of a failed <code>Observable</code>.</p>
<p>The diagnostic <em>log to console</em> is just one more <code>then()</code> in the Promise chain.</p>
<p>You have to adjust the calling component to expect a <code>Promise</code> instead of an <code>Observable</code>:</p>
<code-tabs><code-pane language="ts" name="src/app/toh/hero-list.component.promise.ts (promise-based)" format="linenums">getHeroes() {
  this.heroService.getHeroes()
                   .then(
                     heroes =&gt; this.heroes = heroes,
                     error =&gt;  this.errorMessage = &lt;any&gt;error);
}

addHero (name: string) {
  if (!name) { return; }
  this.heroService.addHero(name)
                   .then(
                     hero  =&gt; this.heroes.push(hero),
                     error =&gt;  this.errorMessage = &lt;any&gt;error);
}
</code-pane><code-pane language="ts" name="src/app/toh/hero-list.component.ts (observable-based)" format="linenums">  getHeroes() {
    this.heroService.getHeroes()
                     .subscribe(
                       heroes =&gt; this.heroes = heroes,
                       error =&gt;  this.errorMessage = &lt;any&gt;error);
  }

  addHero(name: string) {
    if (!name) { return; }
    this.heroService.create(name)
                     .subscribe(
                       hero  =&gt; this.heroes.push(hero),
                       error =&gt;  this.errorMessage = &lt;any&gt;error);
  }
</code-pane></code-tabs><p>The only obvious difference is that you call <code>then()</code> on the returned Promise instead of <code>subscribe</code>.
Both methods take the same functional arguments.</p>
<div class="l-sub-section"><p>The less obvious but critical difference is that these two methods return very different results.</p>
<p>The Promise-based <code>then()</code> returns another Promise. You can keep chaining 
more <code>then()</code> and <code>catch()</code> calls, getting a new promise each time.</p>
<p>The <code>subscribe()</code> method returns a <code>Subscription</code>. A <code>Subscription</code> is not another <code>Observable</code>.
It&#39;s the end of the line for Observables. You can&#39;t call <code>map()</code> on it or call <code>subscribe()</code> again.
The <code>Subscription</code> object has a different purpose, signified by its primary method, <code>unsubscribe</code>.</p>
<p>To understand the implications and consequences of subscriptions, 
watch <a href="https://www.youtube.com/watch?v=3LKMwkuK0ZE">Ben Lesh&#39;s talk on Observables</a> 
or his video course on <a href="https://egghead.io/lessons/rxjs-rxjs-observables-vs-promises">egghead.io</a>.</p>
</div><h2 id="cors">Cross-Origin Requests: Wikipedia example</h2><p>You just learned how to make <code>XMLHttpRequests</code> using the Angular <code>Http</code> service.
This is the most common approach to server communication, but it doesn&#39;t work in all scenarios.</p>
<p>For security reasons, web browsers block <code>XHR</code> calls to a remote server whose origin is different from the origin of the web page.
The <em>origin</em> is the combination of URI scheme, hostname, and port number.
This is called the <a href="https://en.wikipedia.org/wiki/Same-origin_policy">same-origin policy</a>.</p>
<div class="l-sub-section"><p>Modern browsers do allow <code>XHR</code> requests to servers from a different origin if the server supports the
<a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">CORS</a> protocol.
If the server requires user credentials, enable them in the <a href="#headers">request headers</a>.</p>
</div><p>Some servers do not support CORS but do support an older, read-only alternative called <a href="https://en.wikipedia.org/wiki/JSONP">JSONP</a>.
Wikipedia is one such server.</p>
<div class="l-sub-section"><p>This <a href="http://stackoverflow.com/questions/2067472/what-is-jsonp-all-about/2067584#2067584">Stack Overflow answer</a> covers many details of JSONP.</p>
</div><a id="search-wikipedia"></a><h3 id="search-wikipedia">Search Wikipedia</h3>
<p>Here is a simple search that shows suggestions from Wikipedia as the user
types in a text box:</p>
<figure class="image-display"><img src="/resources/images/devguide/server-communication/wiki-1.gif" alt="Wikipedia search app (v.1)" width="250"></figure><p>Wikipedia offers a modern <code>CORS</code> API and a legacy <code>JSONP</code> search API. This example uses the latter.
The Angular <code>Jsonp</code> service both extends the <code>Http</code> service for JSONP and restricts you to <code>GET</code> requests.
All other HTTP methods throw an error because <code>JSONP</code> is a read-only facility.</p>
<p>As always, wrap the interaction with an Angular data access client service inside a dedicated service, here called <code>WikipediaService</code>.</p>
<div class="code-example"><header><h4>src/app/wiki/wikipedia.service.ts</h4></header><code-example language="ts" format="linenums">import { Injectable } from &#39;@angular/core&#39;;
import { Jsonp, URLSearchParams } from &#39;@angular/http&#39;;

import &#39;rxjs/add/operator/map&#39;;

@Injectable()
export class WikipediaService {
  constructor(private jsonp: Jsonp) {}

  search (term: string) {

    let wikiUrl = &#39;http://en.wikipedia.org/w/api.php&#39;;

    let params = new URLSearchParams();
    params.set(&#39;search&#39;, term); // the user&#39;s search value
    params.set(&#39;action&#39;, &#39;opensearch&#39;);
    params.set(&#39;format&#39;, &#39;json&#39;);
    params.set(&#39;callback&#39;, &#39;JSONP_CALLBACK&#39;);

    // TODO: Add error handling
    return this.jsonp
               .get(wikiUrl, { search: params })
               .map(response =&gt; &lt;string[]&gt; response.json()[1]);
  }
}
</code-example></div><p>The constructor expects Angular to inject its <code>Jsonp</code> service, which 
is available because <code>JsonpModule</code> is in the root <code>@NgModule</code> <code>imports</code> array
in <code>app.module.ts</code>.</p>
<a id="query-parameters"></a><h3 id="search-parameters">Search parameters</h3>
<p>The <a href="https://www.mediawiki.org/wiki/API:Opensearch">Wikipedia &quot;opensearch&quot; API</a>
expects four parameters (key/value pairs) to arrive in the request URL&#39;s query string.
The keys are <code>search</code>, <code>action</code>, <code>format</code>, and <code>callback</code>.
The value of the <code>search</code> key is the user-supplied search term to find in Wikipedia.
The other three are the fixed values &quot;opensearch&quot;, &quot;json&quot;, and &quot;JSONP_CALLBACK&quot; respectively.</p>
<div class="l-sub-section"><p>The <code>JSONP</code> technique requires that you pass a callback function name to the server in the query string: <code>callback=JSONP_CALLBACK</code>.
The server uses that name to build a JavaScript wrapper function in its response, which Angular ultimately calls to extract the data.
All of this happens under the hood.</p>
</div><p>If you&#39;re looking for articles with the word &quot;Angular&quot;, you could construct the query string by hand and call <code>jsonp</code> like this:</p>
<div class="code-example"><code-example language="ts" format="">let queryString =
  `?search=${term}&amp;action=opensearch&amp;format=json&amp;callback=JSONP_CALLBACK`;

return this.jsonp
           .get(wikiUrl + queryString)
           .map(response =&gt; &lt;string[]&gt; response.json()[1]);
</code-example></div><p>In more parameterized examples you could build the query string with the Angular <code>URLSearchParams</code> helper:</p>
<div class="code-example"><header><h4>src/app/wiki/wikipedia.service.ts (search parameters)</h4></header><code-example language="ts" format="">let params = new URLSearchParams();
params.set(&#39;search&#39;, term); // the user&#39;s search value
params.set(&#39;action&#39;, &#39;opensearch&#39;);
params.set(&#39;format&#39;, &#39;json&#39;);
params.set(&#39;callback&#39;, &#39;JSONP_CALLBACK&#39;);
</code-example></div><p>This time you call <code>jsonp</code> with <em>two</em> arguments: the <code>wikiUrl</code> and an options object whose <code>search</code> property is the <code>params</code> object.</p>
<div class="code-example"><header><h4>src/app/wiki/wikipedia.service.ts (call jsonp)</h4></header><code-example language="ts" format="">// TODO: Add error handling
return this.jsonp
           .get(wikiUrl, { search: params })
           .map(response =&gt; &lt;string[]&gt; response.json()[1]);
</code-example></div><p><code>Jsonp</code> flattens the <code>params</code> object into the same query string you saw earlier, sending the request 
to the server.</p>
<a id="wikicomponent"></a><h3 id="the-wikicomponent">The WikiComponent</h3>
<p>Now that you have a service that can query the Wikipedia API,
turn your attention to the component (template and class) that takes user input and displays search results.</p>
<div class="code-example"><header><h4>src/app/wiki/wiki.component.ts</h4></header><code-example language="ts" format="linenums">import { Component }        from &#39;@angular/core&#39;;
import { Observable }       from &#39;rxjs/Observable&#39;;

import { WikipediaService } from &#39;./wikipedia.service&#39;;

@Component({
  selector: &#39;my-wiki&#39;,
  template: `
    &lt;h1&gt;Wikipedia Demo&lt;/h1&gt;
    &lt;p&gt;Search after each keystroke&lt;/p&gt;
    &lt;input #term (keyup)=&quot;search(term.value)&quot;/&gt;
    &lt;ul&gt;
      &lt;li *ngFor=&quot;let item of items | async&quot;&gt;{{item}}&lt;/li&gt;
    &lt;/ul&gt;`,
  providers: [ WikipediaService ]
})
export class WikiComponent {
  items: Observable&lt;string[]&gt;;

  constructor (private wikipediaService: WikipediaService) { }

  search (term: string) {
    this.items = this.wikipediaService.search(term);
  }
}
</code-example></div><p>The template presents an <code>&lt;input&gt;</code> element <em>search box</em> to gather search terms from the user,
and calls a <code>search(term)</code> method after each <code>keyup</code> event.</p>
<p>The component&#39;s <code>search(term)</code> method delegates to the <code>WikipediaService</code>, which returns an 
Observable array of string results (<code>Observable&lt;string[]&gt;</code>).
Instead of subscribing to the Observable inside the component, as in the <code>HeroListComponent</code>,
the app forwards the Observable result to the template (via <code>items</code>) where the <code>async</code> pipe 
in the <code>ngFor</code> handles the subscription. Read more about <a href="pipes.html#async-pipe">async pipes</a>
in the <a href="pipes.html">Pipes</a> page.</p>
<div class="l-sub-section"><p>The <a href="pipes.html#async-pipe">async pipe</a> is a good choice in read-only components 
where the component has no need to interact with the data.</p>
<p><code>HeroListComponent</code> can&#39;t use the pipe because <code>addHero()</code> pushes newly created heroes into the list.</p>
</div><a id="wasteful-app"></a><h2 id="a-wasteful-app">A wasteful app</h2>
<p>The Wikipedia search makes too many calls to the server.
It is inefficient and potentially expensive on mobile devices with limited data plans.</p>
<h3 id="1-wait-for-the-user-to-stop-typing">1. Wait for the user to stop typing</h3>
<p>Presently, the code calls the server after every keystroke.
It should only make requests when the user <em>stops typing</em>.
Here&#39;s how it will work after refactoring:</p>
<figure class="image-display"><img src="/resources/images/devguide/server-communication/wiki-2.gif" alt="Wikipedia search app (v.2)" width="250"></figure><h3 id="2-search-when-the-search-term-changes">2. Search when the search term changes</h3>
<p>Suppose a user enters the word <em>angular</em> in the search box and pauses for a while.
The application issues a search request for <em>angular</em>.</p>
<p>Then the user backspaces over the last three letters, <em>lar</em>, and immediately re-types <em>lar</em> before pausing once more.
The search term is still <em>angular</em>. The app shouldn&#39;t make another request.</p>
<h3 id="3-cope-with-out-of-order-responses">3. Cope with out-of-order responses</h3>
<p>The user enters <em>angular</em>, pauses, clears the search box, and enters <em>http</em>.
The application issues two search requests, one for <em>angular</em> and one for <em>http</em>.</p>
<p>Which response arrives first? It&#39;s unpredictable.
When there are multiple requests in-flight, the app should present the responses
in the original request order. 
In this example, the app must always display the results for the <em>http</em> search
no matter which response arrives first.</p>
<p><a id="more-observables"></a></p>
<h2 id="more-fun-with-observables">More fun with Observables</h2>
<p>You could make changes to the <code>WikipediaService</code>, but for a better
user experience, create a copy of the <code>WikiComponent</code> instead and make it smarter,
with the help of some nifty Observable operators.</p>
<p>Here&#39;s the <code>WikiSmartComponent</code>, shown next to the original <code>WikiComponent</code>:</p>
<code-tabs><code-pane language="ts" name="src/app/wiki/wiki-smart.component.ts" format="linenums">import { Component, OnInit } from &#39;@angular/core&#39;;

import { Observable } from &#39;rxjs/Observable&#39;;
import &#39;rxjs/add/operator/debounceTime&#39;;
import &#39;rxjs/add/operator/distinctUntilChanged&#39;;
import &#39;rxjs/add/operator/switchMap&#39;;

import { Subject } from &#39;rxjs/Subject&#39;;

import { WikipediaService } from &#39;./wikipedia.service&#39;;

@Component({
  selector: &#39;my-wiki-smart&#39;,
  template: `
    &lt;h1&gt;Smarter Wikipedia Demo&lt;/h1&gt;
    &lt;p&gt;Search when typing stops&lt;/p&gt;
    &lt;input #term (keyup)=&quot;search(term.value)&quot;/&gt;
    &lt;ul&gt;
      &lt;li *ngFor=&quot;let item of items | async&quot;&gt;{{item}}&lt;/li&gt;
    &lt;/ul&gt;`,
  providers: [ WikipediaService ]
})
export class WikiSmartComponent implements OnInit {
  items: Observable&lt;string[]&gt;;

  constructor (private wikipediaService: WikipediaService) {}

  private searchTermStream = new Subject&lt;string&gt;();
  search(term: string) { this.searchTermStream.next(term); }

  ngOnInit() {
    this.items = this.searchTermStream
      .debounceTime(300)
      .distinctUntilChanged()
      .switchMap((term: string) =&gt; this.wikipediaService.search(term));
  }
}
</code-pane><code-pane language="ts" name="src/app/wiki/wiki.component.ts" format="linenums">import { Component }        from &#39;@angular/core&#39;;
import { Observable }       from &#39;rxjs/Observable&#39;;

import { WikipediaService } from &#39;./wikipedia.service&#39;;

@Component({
  selector: &#39;my-wiki&#39;,
  template: `
    &lt;h1&gt;Wikipedia Demo&lt;/h1&gt;
    &lt;p&gt;Search after each keystroke&lt;/p&gt;
    &lt;input #term (keyup)=&quot;search(term.value)&quot;/&gt;
    &lt;ul&gt;
      &lt;li *ngFor=&quot;let item of items | async&quot;&gt;{{item}}&lt;/li&gt;
    &lt;/ul&gt;`,
  providers: [ WikipediaService ]
})
export class WikiComponent {
  items: Observable&lt;string[]&gt;;

  constructor (private wikipediaService: WikipediaService) { }

  search (term: string) {
    this.items = this.wikipediaService.search(term);
  }
}
</code-pane></code-tabs><p>While the templates are virtually identical,
there&#39;s a lot more RxJS in the &quot;smart&quot; version, 
starting with <code>debounceTime</code>, <code>distinctUntilChanged</code>, and <code>switchMap</code> operators,
imported as <a href="#rxjs-library">described above</a>.</p>
<a id="create-stream"></a><h3 id="create-a-stream-of-search-terms">Create a stream of search terms</h3>
<p>The <code>WikiComponent</code> passes a new search term directly to the <code>WikipediaService</code> after every keystroke.</p>
<p>The <code>WikiSmartComponent</code> class turns the user&#39;s keystrokes into an Observable <em>stream of search terms</em>
with the help of a <code>Subject</code>, which you import from RxJS:</p>
<div class="code-example"><code-example language="ts" format="">import { Subject } from &#39;rxjs/Subject&#39;;
</code-example></div><p>The component creates a <code>searchTermStream</code> as a <code>Subject</code> of type <code>string</code>.
The <code>search()</code> method adds each new search box value to that stream via the subject&#39;s <code>next()</code> method.</p>
<div class="code-example"><code-example language="ts" format="">private searchTermStream = new Subject&lt;string&gt;();
search(term: string) { this.searchTermStream.next(term); }
</code-example></div><a id="listen-for-search-terms"></a><h3 id="listen-for-search-terms">Listen for search terms</h3>
<p>The <code>WikiSmartComponent</code> listens to the <em>stream of search terms</em> and 
processes that stream <em>before</em> calling the service.</p>
<div class="code-example"><code-example language="ts" format="">this.items = this.searchTermStream
  .debounceTime(300)
  .distinctUntilChanged()
  .switchMap((term: string) =&gt; this.wikipediaService.search(term));
</code-example></div><ul>
<li><p><a href="https://github.com/Reactive-Extensions/RxJS/blob/master/doc/api/core/operators/debounce.md" target="_blank" title="debounce operator"><i>debounceTime</i></a>
waits for the user to stop typing for at least 300 milliseconds.</p>
</li>
<li><p><a href="https://github.com/Reactive-Extensions/RxJS/blob/master/doc/api/core/operators/distinctuntilchanged.md" target="_blank" title="distinctUntilChanged operator"><i>distinctUntilChanged</i></a>
ensures that the service is called only when the new search term is different from the previous search term.</p>
</li>
<li><p>The <a href="https://github.com/Reactive-Extensions/RxJS/blob/master/doc/api/core/operators/flatmaplatest.md" target="_blank" title="switchMap operator"><i>switchMap</i></a>
calls the <code>WikipediaService</code> with a fresh, debounced search term and coordinates the stream(s) of service response.</p>
</li>
</ul>
<p>The role of <code>switchMap</code> is particularly important.
The <code>WikipediaService</code> returns a separate Observable of string arrays (<code>Observable&lt;string[]&gt;</code>) for each search request.
The user could issue multiple requests before a slow server has had time to reply,
which means a backlog of response Observables could arrive at the client, at any moment, in any order.</p>
<p>The <code>switchMap</code> returns its own Observable that <em>combines</em> all <code>WikipediaService</code> response Observables,
re-arranges them in their original request order,
and delivers to subscribers only the most recent search results.</p>
<a id="xsrf"></a><div class="l-main-section"></div><h2 id="guarding-against-cross-site-request-forgery">Guarding against Cross-Site Request Forgery</h2>
<p>In a cross-site request forgery (CSRF or XSRF), an attacker tricks the user into visiting
a different web page with malignant code that secretly sends a malicious request to your application&#39;s web server.</p>
<p>The server and client application must work together to thwart this attack.
Angular&#39;s <code>Http</code> client does its part by applying a default <code>CookieXSRFStrategy</code> automatically to all requests.</p>
<p>The <code>CookieXSRFStrategy</code> supports a common anti-XSRF technique in which the server sends a randomly
generated authentication token in a cookie named <code>XSRF-TOKEN</code>. 
The HTTP client adds an <code>X-XSRF-TOKEN</code> header with that token value to subsequent requests. 
The server receives both the cookie and the header, compares them, and processes the request only if the cookie and header match.</p>
<p>See the <a href="security.html#xsrf">XSRF topic on the Security page</a> for more information about XSRF and Angular&#39;s <code>XSRFStrategy</code> counter measures.</p>
<a id="override-default-request-options"></a><div class="l-main-section"></div><h2 id="override-default-request-headers-and-other-request-options-">Override default request headers (and other request options)</h2>
<p>Request options (such as headers) are merged into the
<a href="https://angular.io/docs/ts/latest/api/http/index/BaseRequestOptions-class.html" title="API: BaseRequestOptions">default <em>RequestOptions</em></a> 
before the request is processed.
The <code>HttpModule</code> provides these default options via the <code>RequestOptions</code> token.</p>
<p>You can override these defaults to suit your application needs
by creating a custom sub-class of <code>RequestOptions</code>
that sets the default options for the application.</p>
<p>This sample creates a class that sets the default <code>Content-Type</code> header to JSON.
It exports a constant with the necessary <code>RequestOptions</code> provider to simplify registration in <code>AppModule</code>.</p>
<div class="code-example"><header><h4>src/app/default-request-options.service.ts</h4></header><code-example language="ts" format="">import { Injectable } from &#39;@angular/core&#39;;
import { BaseRequestOptions, RequestOptions } from &#39;@angular/http&#39;;

@Injectable()
export class DefaultRequestOptions extends BaseRequestOptions {

  constructor() {
    super();

    // Set the default &#39;Content-Type&#39; header
    this.headers.set(&#39;Content-Type&#39;, &#39;application/json&#39;);
  }
}

export const requestOptionsProvider = { provide: RequestOptions, useClass: DefaultRequestOptions };
</code-example></div><p>Then it registers the provider in the root <code>AppModule</code>.</p>
<div class="code-example"><header><h4>src/app/app.module.ts (provide default request header)</h4></header><code-example language="ts" format="">providers: [ requestOptionsProvider ],
</code-example></div><div class="l-sub-section"><p>Remember to include this provider during setup when unit testing the app&#39;s HTTP services.</p>
</div><p>After this change, the <code>header</code> option setting in <code>HeroService.create()</code> is no longer necessary,</p>
<div class="code-example"><header><h4>src/app/toh/hero.service.ts (create)</h4></header><code-example language="ts" format="">  create(name: string): Observable&lt;Hero&gt; {
    let headers = new Headers({ &#39;Content-Type&#39;: &#39;application/json&#39; });
    let options = new RequestOptions({ headers: headers });

    return this.http.post(this.heroesUrl, { name }, options)
                    .map(this.extractData)
                    .catch(this.handleError);
  }
</code-example></div><p>You can confirm that <code>DefaultRequestOptions</code> is working by examing HTTP requests in the browser developer tools&#39; network tab.
If you&#39;re short-circuiting the server call with something like the <a href="#in-mem-web-api"><em>in-memory web api</em></a>,
try commenting-out the <code>create</code> header option, 
set a breakpoint on the POST call, and step through the request processing
to verify the header is there.</p>
<p>Individual requests options, like this one, take precedence over the default <code>RequestOptions</code>.
It might be wise to keep the <code>create</code> request header setting for extra safety.</p>
<a id="in-mem-web-api"></a><div class="l-main-section"></div><h2 id="appendix-tour-of-heroes-_in-memory-web-api_">Appendix: Tour of Heroes <em>in-memory web api</em></h2>
<p>If the app only needed to retrieve data, you could get the heroes from a <code>heroes.json</code> file:</p>
<div class="code-example"><header><h4>src/app/heroes.json</h4></header><code-example language="json" format=".">{
  "data": [
    { "id": 1, "name": "Windstorm" },
    { "id": 2, "name": "Bombasto" },
    { "id": 3, "name": "Magneta" },
    { "id": 4, "name": "Tornado" }
  ]
}
</code-example></div><div class="l-sub-section"><p>You wrap the heroes array in an object with a <code>data</code> property for the same reason that a data server does:
to mitigate the <a href="http://stackoverflow.com/questions/3503102/what-are-top-level-json-arrays-and-why-are-they-a-security-risk">security risk</a>
posed by top-level JSON arrays.</p>
</div><p>You&#39;d set the endpoint to the JSON file like this:</p>
<div class="code-example"><header><h4>src/app/toh/hero.service.ts</h4></header><code-example language="ts" format="">private heroesUrl = &#39;app/heroes.json&#39;; // URL to JSON file
</code-example></div><p>The <em>get heroes</em> scenario would work,
but since the app can&#39;t save changes to a JSON file, it needs a web API server.
Because there isn&#39;t a real server for this demo, 
it substitutes the Angular <em>in-memory web api</em> simulator for the actual XHR backend service.</p>
<div class="l-sub-section"><p>The in-memory web api is not part of Angular <em>proper</em>. 
It&#39;s an optional service in its own 
<a href="https://github.com/angular/in-memory-web-api" target="_blank" title="In-memory Web API"><i>angular-in-memory-web-api</i></a>
library installed with npm (see <code>package.json</code>).</p>
<p>See the
<a href="https://github.com/angular/in-memory-web-api/blob/master/README.md" target="_blank" title="In-memory Web API &quot;README.md&quot;"><i>README file</i></a>
for configuration options, default behaviors, and limitations.</p>
</div><p>The in-memory web API gets its data from a custom application class with a <code>createDb()</code>
method that returns a map whose keys are collection names and whose values
are arrays of objects in those collections.</p>
<p>Here&#39;s the class for this sample, based on the JSON data:</p>
<div class="code-example"><header><h4>src/app/hero-data.ts</h4></header><code-example language="ts" format="">import { InMemoryDbService } from &#39;angular-in-memory-web-api&#39;;
export class HeroData implements InMemoryDbService {
  createDb() {
    let heroes = [
      { id: 1, name: &#39;Windstorm&#39; },
      { id: 2, name: &#39;Bombasto&#39; },
      { id: 3, name: &#39;Magneta&#39; },
      { id: 4, name: &#39;Tornado&#39; }
    ];
    return {heroes};
  }
}
</code-example></div><p>Ensure that the <code>HeroService</code> endpoint refers to the web API:</p>
<div class="code-example"><header><h4>src/app/toh/hero.service.ts</h4></header><code-example language="ts" format="">private heroesUrl = &#39;api/heroes&#39;;  // URL to web API
</code-example></div><p>Finally, redirect client HTTP requests to the in-memory web API by
adding the <code>InMemoryWebApiModule</code> to the <code>AppModule.imports</code> list.
At the same time, call its <code>forRoot()</code> configuration method with the <code>HeroData</code> class.</p>
<div class="code-example"><header><h4>src/app/app.module.ts</h4></header><code-example language="ts" format="">InMemoryWebApiModule.forRoot(HeroData)
</code-example></div><h3 id="how-it-works">How it works</h3>
<p>Angular&#39;s <code>http</code> service delegates the client/server communication tasks
to a helper service called the <code>XHRBackend</code>.</p>
<p>Using standard Angular provider registration techniques, the <code>InMemoryWebApiModule</code>
replaces the default <code>XHRBackend</code> service with its own in-memory alternative.
At the same time, the <code>forRoot</code> method initializes the in-memory web API with the <em>seed data</em> from the mock hero dataset.</p>
<div class="l-sub-section"><p>The <code>forRoot()</code> method name is a strong reminder that you should only call the <code>InMemoryWebApiModule</code> <em>once</em>,
while setting the metadata for the root <code>AppModule</code>. Don&#39;t call it again.</p>
</div><p>Here is the final, revised version of <span ngio-ex>src/app/app.module.ts</span>, demonstrating these steps.</p>
<div class="code-example"><header><h4>src/app/app.module.ts (excerpt)</h4></header><code-example language="ts" format="">import { NgModule }      from &#39;@angular/core&#39;;
import { BrowserModule } from &#39;@angular/platform-browser&#39;;
import { FormsModule }   from &#39;@angular/forms&#39;;
import { HttpModule, JsonpModule } from &#39;@angular/http&#39;;


import { InMemoryWebApiModule }     from &#39;angular-in-memory-web-api&#39;;
import { HeroData }                 from &#39;./hero-data&#39;;
import { requestOptionsProvider }   from &#39;./default-request-options.service&#39;;

import { AppComponent }             from &#39;./app.component&#39;;

import { HeroListComponent }        from &#39;./toh/hero-list.component&#39;;
import { HeroListPromiseComponent } from &#39;./toh/hero-list.component.promise&#39;;

import { WikiComponent }      from &#39;./wiki/wiki.component&#39;;
import { WikiSmartComponent } from &#39;./wiki/wiki-smart.component&#39;;

@NgModule({
  imports: [
    BrowserModule,
    FormsModule,
    HttpModule,
    JsonpModule,
    InMemoryWebApiModule.forRoot(HeroData)
  ],
  declarations: [
    AppComponent,
    HeroListComponent,
    HeroListPromiseComponent,
    WikiComponent,
    WikiSmartComponent
  ],
  providers: [ requestOptionsProvider ],
  bootstrap: [ AppComponent ]
})
export class AppModule {}
</code-example></div><div class="alert is-important"><p>Import the <code>InMemoryWebApiModule</code> <em>after</em> the <code>HttpModule</code> to ensure that 
the <code>XHRBackend</code> provider of the <code>InMemoryWebApiModule</code> supersedes all others.</p>
</div><p>See the full source code in the <live-example></live-example>.</p><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--><!-- CHECK IF CURRENT PAGE IS SET, THEN SET NEXT PAGE--><!-- SET CURRENT PAGE FLAG WHEN YOU PASS IT--></article><div data-swiftype-index="false" class="main-footer"><nav class="background-midnight grid-fluid"><div class="c3 main-footer-branding"><div class="logo-inverse-large"></div></div><div class="c2"><h3 class="text-headline">RESOURCES</h3><ul class="text-body"><!-- TODO: (ericjim) make a libraries page to showcase all angular libraries--><!--li <a href="/libraries.html">Libraries</a>--><li><a href="/about/">About</a></li><li><a href="/resources/#Education">Books & Training</a></li><li><a href="/resources/">Tools & Libraries</a></li><li><a href="/resources/">Community</a></li><li><a href="/presskit.html">Press Kit</a></li></ul></div><div class="c2"><h3 class="text-headline">HELP</h3><ul class="text-body"><li><a href="http://stackoverflow.com/questions/tagged/angular2">Stack Overflow</a></li><li><a href="https://gitter.im/angular/angular">Gitter</a></li><li><a href="https://groups.google.com/forum/#!forum/angular"> Google Group</a></li><li><a href="https://github.com/angular/angular/issues"> Report Issues</a></li><li><a class="footer-feedback" ng-click="appCtrl.openFeedback()" aria-label="Submit feedback on this page"> Site Feedback</a></li></ul></div><div class="c2"><h3 class="text-headline">COMMUNITY</h3><ul class="text-body"><li><a href="/events.html">Events</a></li><li><a href="http://www.meetup.com/topics/angularjs/">Meetups</a></li><li><a href="https://twitter.com/angular"> Twitter</a></li><li><a href="https://github.com/angular/angular"> GitHub</a></li><li><a href="/contribute.html"> Contribute</a></li></ul></div><div class="c2"><h3 class="text-headline">LANGUAGES</h3><ul class="text-body"><li><a href="https://angular.cn/">中文版</a></li></ul></div></nav><footer class="background-midnight"><small class="text-caption">Powered by Google ©2010-2017. Code licensed under an <a href="/license">MIT-style License</a>. Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.</small><a aria-label="View Style Guide" href="/docs/ts/latest/styleguide.html" title="Style Guide" class="styleguide-trigger"><span class="icon-favorite"></span></a></footer></div><!-- VENDORS --><script src="/resources/js/vendor/prettify.js"></script><script src="/resources/js/vendor/lang-basic.js"></script><script src="/resources/js/vendor/lang-dart.js"></script><script src="/resources/js/vendor/lodash.js"></script><script src="/resources/js/vendor/clipboard.min.js"></script><!-- Angular Material Dependencies --><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.0/angular.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.0/angular-animate.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.0/angular-aria.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.0.0/angular-material.min.js"></script><!-- Firebase -->
<script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
<!-- AngularFire -->
<script src="https://cdn.firebase.com/libs/angularfire/1.2.0/angularfire.min.js"></script>
<!-- Angular.io Site JS --><script src="/resources/js/site.js"></script><script src="/resources/js/util.js"></script><script src="/resources/js/controllers/app-controller.js"></script><script src="/resources/js/controllers/resources-controller.js"></script><script src="/resources/js/directives/cheatsheet.js"></script><script src="/resources/js/directives/api-list.js"></script><script src="/resources/js/directives/bio.js"></script><script src="/resources/js/directives/bold.js"></script><script src="/resources/js/directives/announcement-bar.js"></script><script src="/resources/js/directives/code.js"></script><script src="/resources/js/directives/copy.js"></script><script src="/resources/js/directives/code-tabs.js"></script><script src="/resources/js/directives/code-pane.js"></script><script src="/resources/js/directives/code-example.js"></script><script src="/resources/js/directives/if-docs.js"></script><script src="/resources/js/directives/live-example.js"></script><script src="/resources/js/directives/ngio-ex-path.js"></script><script src="/resources/js/directives/scroll-y-offset-element.js"></script><!-- GA --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-8594346-15', 'auto');
ga('send', 'pageview')
</script><!-- SWIFTYPE --><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','VsuU7kH5Hnnj9tfyNvfK','2.0.0');

</script><!-- Google Feedback --><script src="//www.gstatic.com/feedback/api.js" type="text/javascript"></script><!-- Twitter Widget --><script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}})(document,"script","twitter-wjs");</script></body></html>